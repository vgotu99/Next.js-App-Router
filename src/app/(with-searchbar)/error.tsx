"use client";
import { useRouter } from "next/navigation";
import { startTransition, useEffect } from "react";

// μ„λ²„, ν΄λΌμ΄μ–ΈνΈμ—μ„ λ°μƒν•λ” λ¨λ“  μ—λ¬μ— λ€μ‘ν•  μ μλ„λ΅ ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈλ΅ μ§€μ •ν•΄μ¤€λ‹¤.

// error μ»΄ν¬λ„νΈλ” κ°™μ€, ν•μ„ κ²½λ΅μ— μ΅΄μ¬ν•λ” μ»΄ν¬λ„νΈμ—μ„ μ—λ¬κ°€ λ°μƒ μ‹ λ λ”λ§ λλ” μ»΄ν¬λ„νΈμ΄λ‹¤.
const Error = ({
  error /* errorλΌλ” μ΄λ¦„μ propsλ” ν„μ¬ λ°μƒν• μ—λ¬ μ •λ³΄μ΄λ‹¤. */,
  reset /* μ—λ¬ μƒνƒλ¥Ό μ΄κΈ°ν™”ν•κ³  μ—λ¬κ°€ λ°μƒν• μ»΄ν¬λ„νΈλ¥Ό λ‹¤μ‹ ν•λ² λ λ”λ§μ‹μΌλ³΄λ” κΈ°λ¥μ„ κ°€μ§„ ν•¨μμ΄λ‹¤.
  λ‹¤λ§ μ„λ²„μ—κ² λ°μ΄ν„°λ¥Ό μ¬μ”μ²­ν•μ§€λ” μ•κ³  λ°›μ•λ λ°μ΄ν„°λ¥Ό κ°€μ§€κ³  ν΄λΌμ΄μ–ΈνΈμ—μ„ λ λ”λ§μ„ μ¬μ‹λ„ν•κΈ°λ§ ν•λ‹¤.
  π‘† κ²°λ΅ : ν΄λΌμ΄μ–ΈνΈ μ‚¬μ΄λ“(ν΄λΌμ΄μ–ΈνΈ μ»΄ν¬λ„νΈ)μ—μ„ λ°μƒν• μ¤λ¥λ§ λ³µκµ¬ν•  μ μλ‹¤.
  π‘‡ μ„λ²„ μ‚¬μ΄λ“ errorμ€μ„ λ• λ‹¤μ‹ μ‹λ„ν•λ” λ°©λ²•!
    - window.location.reload(): λΈλΌμ°μ € μμ²΄λ¥Ό λ¦¬λ΅λ“
    - router.refresh() + reset(): μ„λ²„ μ»΄ν¬λ„νΈλ§ μ¬μ”μ²­ν•μ—¬ λ λ”λ§ + λ¦¬μ…‹ ν•¨μ
   */,
}: {
  error: Error;
  reset: () => void;
}) => {
  const router = useRouter();

  useEffect(() => {
    console.error(error.message);
  }, [error]);

  const handleReset = () => {
    startTransition(() => {
      // μ „λ‹¬λ°›μ€ μ½λ°±ν•¨μμ—μ„ UIλ¥Ό λ³€κ²½μ‹ν‚¤λ” μ‘μ—…λ“¤μ„ λ¨λ‘ μΌκ΄„μ μΌλ΅ μ²λ¦¬ν•λ„λ΅ ν•λ” Reactμ methodμ΄λ‹¤.
      // router.refresh()κ°€ λΉ„λ™κΈ°μ μΌλ΅ λ™μ‘ν•κ³  reset()μ€ λ™κΈ°μ μΌλ΅ λ™μ‘ν•λ”λ° router.refresh()κ°€ λ¨Όμ € μ‹¤ν–‰λ μ΄ν›„ reset()μ΄ μ‹¤ν–‰λμ–΄μ•Όν•κΈ°μ— startTransition methodλ¥Ό μ‚¬μ©ν•¨
      router.refresh(); // ν„μ¬ νμ΄μ§€μ— ν•„μ”ν• μ„λ²„ μ»΄ν¬λ„νΈλ“¤μ„ λ‹¤μ‹ μ”μ²­ν•μ—¬ λ¦¬λ λ”λ§, λΉ„λ™κΈ°μ μΌλ΅ λ™μ‘ν•λ‹¤.
      reset();
    });
  };

  return (
    <div>
      <h3>μ¤λ¥κ°€ λ°μƒν–μµλ‹λ‹¤.</h3>
      <button onClick={handleReset}>λ‹¤μ‹ μ‹λ„</button>
    </div>
  );
};

export default Error;
